{"version":3,"file":"ngx-scanner-qrcode-single.js.map","sources":["ng://ngx-scanner-qrcode-single/lib/ngx-scanner-qrcode-single.default.ts","ng://ngx-scanner-qrcode-single/lib/ngx-scanner-qrcode-single.helper.ts","ng://ngx-scanner-qrcode-single/lib/ngx-scanner-qrcode-single.service.ts","ng://ngx-scanner-qrcode-single/lib/ngx-scanner-qrcode-single.component.ts","ng://ngx-scanner-qrcode-single/lib/ngx-scanner-qrcode-single.module.ts"],"sourcesContent":["import { ScannerQRCodeConfig } from \"./ngx-scanner-qrcode-single.options\";\r\n\r\nexport const MEDIA_STREAM_DEFAULT: MediaStreamConstraints = {\r\n  audio: false,\r\n  video: true\r\n};\r\n\r\nexport const CONFIG_DEFAULT: ScannerQRCodeConfig = {\r\n  src: '',\r\n  fps: 30,\r\n  vibrate: 300,\r\n  isBeep: true,\r\n  constraints: MEDIA_STREAM_DEFAULT,\r\n  canvasStyles: {\r\n    font: '15px serif',\r\n    lineWidth: 1,\r\n    strokeStyle: 'green',\r\n    fillStyle: '#55f02880'\r\n  } as CanvasRenderingContext2D\r\n};","import jsQR from \"jsqr\";\r\nimport { AsyncSubject } from \"rxjs\";\r\nimport { CONFIG_DEFAULT } from \"./ngx-scanner-qrcode-single.default\";\r\nimport { Point, ScannerQRCodeConfig, ScannerQRCodeResult, ScannerQRCodeSelectedFiles } from \"./ngx-scanner-qrcode-single.options\";\r\n\r\n/**\r\n * PROP_EXISTS\r\n * @param obj \r\n * @param path \r\n * @returns \r\n */\r\nexport const PROP_EXISTS = (obj: any, path: string) => {\r\n  return !!path.split(\".\").reduce((obj, prop) => {\r\n      return obj && obj[prop] ? obj[prop] : undefined;\r\n  }, obj);\r\n};\r\n\r\n/**\r\n * OVERRIDES\r\n * @param variableKey \r\n * @param config \r\n * @param defaultConfig \r\n * @returns \r\n */\r\nexport const OVERRIDES = (variableKey: string, config: any, defaultConfig: any) => {\r\n  if (config && Object.keys(config[variableKey]).length) {\r\n    for (const key in defaultConfig) {\r\n      const cloneDeep = JSON.parse(JSON.stringify({ ...config[variableKey], ...{ [key]: (defaultConfig as any)[key] } }));\r\n      config[variableKey] = config[variableKey] && config[variableKey].hasOwnProperty(key) ? config[variableKey] : cloneDeep;\r\n    }\r\n    return config[variableKey];\r\n  } else {\r\n    return defaultConfig;\r\n  }\r\n};\r\n\r\n/**\r\n * Rxjs complete\r\n * @param as\r\n * @param data\r\n * @param error\r\n */\r\nexport const AS_COMPLETE = (as: AsyncSubject<any>, data: any, error?: any) => {\r\n  error ? as.error(error) : as.next(data);\r\n  as.complete();\r\n};\r\n\r\n/**\r\n * CAMERA_BEEP\r\n * @param isPlay \r\n * @returns \r\n */\r\nexport const PLAY_AUDIO = (isPlay: boolean = false) => {\r\n  if (isPlay === false) return;\r\n  const audio = new Audio('data:audio/wav;base64,UklGRl9vT19XQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YU' + Array(300).join('101'));\r\n  // when the sound has been loaded, execute your code\r\n  audio.oncanplaythrough = () => {\r\n    const promise = audio.play();\r\n    if (promise) {\r\n      promise.catch((e) => {\r\n        if (e.name === \"NotAllowedError\" || e.name === \"NotSupportedError\") {\r\n          // console.log(e.name);\r\n        }\r\n      });\r\n    }\r\n  };\r\n};\r\n\r\n/**\r\n * DRAW_RESULT_APPEND_CHILD\r\n * @param code \r\n * @param oriCanvas \r\n * @param elTarget \r\n * @param canvasStyles \r\n */\r\nexport const DRAW_RESULT_APPEND_CHILD = (code: ScannerQRCodeResult, oriCanvas: HTMLCanvasElement, elTarget: HTMLCanvasElement | HTMLDivElement, canvasStyles: CanvasRenderingContext2D) => {\r\n  let widthZoom;\r\n  let heightZoom;\r\n  let oriWidth = oriCanvas.width;\r\n  let oriHeight = oriCanvas.height;\r\n  let oriWHRatio = oriWidth / oriHeight;\r\n  let imgWidth = parseInt(getComputedStyle(oriCanvas).width);\r\n  let imgHeight = parseInt(getComputedStyle(oriCanvas).height);\r\n  let imgWHRatio = imgWidth / imgHeight;\r\n  elTarget.innerHTML = '';\r\n\r\n  if (oriWHRatio > imgWHRatio) {\r\n    widthZoom = imgWidth / oriWidth;\r\n    heightZoom = imgWidth / oriWHRatio / oriHeight;\r\n  } else {\r\n    heightZoom = imgHeight / oriHeight;\r\n    widthZoom = (imgHeight * oriWHRatio) / oriWidth;\r\n  }\r\n\r\n  // New canvas\r\n  let cvs = document.createElement(\"canvas\");\r\n  let ctx = cvs.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n  let loc: any = {};\r\n  let X: any = [];\r\n  let Y: any = [];\r\n  let fontSize = 0;\r\n  let svgSize = 0;\r\n\r\n  let num = PROP_EXISTS(canvasStyles,'font.replace') && canvasStyles.font.replace(/[^0-9]/g, '');\r\n  if (/[0-9]/g.test(num)) {\r\n    fontSize = parseFloat(num);\r\n    svgSize = (widthZoom || 1) * fontSize;\r\n    if (Number.isNaN(svgSize)) {\r\n      svgSize = fontSize;\r\n    }\r\n  }\r\n\r\n  // Point x,y\r\n  const points = code.location;\r\n  const drawFrame = (begin: Point, end: Point, j: number) => {\r\n    ctx.beginPath();\r\n    ctx.moveTo(begin.x, begin.y);\r\n    ctx.lineTo(end.x, end.y);\r\n    for (let key in canvasStyles) {\r\n      (ctx as any)[key] = (canvasStyles as any)[key];\r\n    }\r\n    ctx.stroke();\r\n    const xj = PROP_EXISTS(begin,'x') ? begin.x : 0;\r\n    const yj = PROP_EXISTS(begin,'y') ? begin.y : 0;\r\n    loc[`x${j + 1}`] = xj;\r\n    loc[`y${j + 1}`] = yj;\r\n    X.push(xj);\r\n    Y.push(yj);\r\n  };\r\n  drawFrame(points.topLeftCorner, points.topRightCorner, 0);\r\n  drawFrame(points.topRightCorner, points.bottomRightCorner, 1);\r\n  drawFrame(points.bottomRightCorner, points.bottomLeftCorner, 2);\r\n  drawFrame(points.bottomLeftCorner, points.topLeftCorner, 3);\r\n\r\n  // Min max\r\n  let maxX = Math.max(...X);\r\n  let minX = Math.min(...X);\r\n  let maxY = Math.max(...Y);\r\n  let minY = Math.min(...Y);\r\n\r\n  // Add class\r\n  cvs.setAttribute('class', 'qrcode-polygon');\r\n\r\n  // Size with screen zoom\r\n  if (oriWHRatio > imgWHRatio) {\r\n    cvs.style.top = minY * heightZoom + (imgHeight - imgWidth / oriWHRatio) * 0.5 + \"px\";\r\n    cvs.style.left = minX * widthZoom + \"px\";\r\n    cvs.width = (maxX - minX) * widthZoom;\r\n    cvs.height = (maxY - minY) * widthZoom;\r\n  } else {\r\n    cvs.style.top = minY * heightZoom + \"px\";\r\n    cvs.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n    cvs.width = (maxX - minX) * heightZoom;\r\n    cvs.height = (maxY - minY) * heightZoom;\r\n  }\r\n\r\n  // Style for canvas\r\n  for (const key in canvasStyles) {\r\n    (ctx as any)[key] = (canvasStyles as any)[key];\r\n  }\r\n\r\n  // polygon [x,y, x,y, x,y.....];\r\n  const polygon = [];\r\n  for (let k = 0; k < X.length; k++) {\r\n    polygon.push((loc[`x${k + 1}`] - minX) * heightZoom);\r\n    polygon.push((loc[`y${k + 1}`] - minY) * widthZoom);\r\n  }\r\n\r\n  // Copy array\r\n  const shape = polygon.slice(0) as any;\r\n\r\n  // Draw polygon\r\n  ctx.beginPath();\r\n  ctx.moveTo(shape.shift(), shape.shift());\r\n  while (shape.length) {\r\n    ctx.lineTo(shape.shift(), shape.shift()); //x,y\r\n  }\r\n  ctx.closePath();\r\n  ctx.fill();\r\n  ctx.stroke();\r\n\r\n  if (fontSize) {\r\n    // Tooltip result\r\n    const qrcodeTooltipTemp = document.createElement('div');\r\n    qrcodeTooltipTemp.setAttribute('class', 'qrcode-tooltip-temp');\r\n    qrcodeTooltipTemp.innerText = code.data;\r\n    const xmlString = `<?xml version=\"1.0\" encoding=\"utf-8\"?><svg version=\"1.1\" class=\"qrcode-tooltip-clipboard\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"${svgSize}\" height=\"${svgSize}\" x=\"0px\" y=\"0px\" viewBox=\"0 0 115.77 122.88\" xml:space=\"preserve\"><g><path d=\"M89.62,13.96v7.73h12.19h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02v0.02 v73.27v0.01h-0.02c-0.01,3.84-1.57,7.33-4.1,9.86c-2.51,2.5-5.98,4.06-9.82,4.07v0.02h-0.02h-61.7H40.1v-0.02 c-3.84-0.01-7.34-1.57-9.86-4.1c-2.5-2.51-4.06-5.98-4.07-9.82h-0.02v-0.02V92.51H13.96h-0.01v-0.02c-3.84-0.01-7.34-1.57-9.86-4.1 c-2.5-2.51-4.06-5.98-4.07-9.82H0v-0.02V13.96v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07V0h0.02h61.7 h0.01v0.02c3.85,0.01,7.34,1.57,9.86,4.1c2.5,2.51,4.06,5.98,4.07,9.82h0.02V13.96L89.62,13.96z M79.04,21.69v-7.73v-0.02h0.02 c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v64.59v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h12.19V35.65 v-0.01h0.02c0.01-3.85,1.58-7.34,4.1-9.86c2.51-2.5,5.98-4.06,9.82-4.07v-0.02h0.02H79.04L79.04,21.69z M105.18,108.92V35.65v-0.02 h0.02c0-0.91-0.39-1.75-1.01-2.37c-0.61-0.61-1.46-1-2.37-1v0.02h-0.01h-61.7h-0.02v-0.02c-0.91,0-1.75,0.39-2.37,1.01 c-0.61,0.61-1,1.46-1,2.37h0.02v0.01v73.27v0.02h-0.02c0,0.91,0.39,1.75,1.01,2.37c0.61,0.61,1.46,1,2.37,1v-0.02h0.01h61.7h0.02 v0.02c0.91,0,1.75-0.39,2.37-1.01c0.61-0.61,1-1.46,1-2.37h-0.02V108.92L105.18,108.92z\"></path></g></svg> `;\r\n    const xmlDom = new DOMParser().parseFromString(xmlString, 'application/xml');\r\n    const svgDom = qrcodeTooltipTemp.ownerDocument.importNode(xmlDom.documentElement, true);\r\n    qrcodeTooltipTemp.appendChild(svgDom);\r\n    svgDom.addEventListener(\"click\", () => window.navigator['clipboard'].writeText(code.data));\r\n\r\n    // Tooltip box\r\n    const qrcodeTooltip = document.createElement('div');\r\n    qrcodeTooltip.setAttribute('class', 'qrcode-tooltip');\r\n    qrcodeTooltip.appendChild(qrcodeTooltipTemp);\r\n    heightZoom = imgHeight / oriHeight;\r\n    widthZoom = (imgHeight * oriWHRatio) / oriWidth;\r\n    qrcodeTooltip.style.fontSize = widthZoom * fontSize + 'px';\r\n    qrcodeTooltip.style.top = minY * heightZoom + \"px\";\r\n    qrcodeTooltip.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n    qrcodeTooltip.style.width = (maxX - minX) * heightZoom + \"px\";\r\n    qrcodeTooltip.style.height = (maxY - minY) * heightZoom + \"px\";\r\n\r\n    // Result text\r\n    const resultText = document.createElement('span');\r\n    resultText.innerText = code.data;\r\n    resultText.style.fontSize = widthZoom * fontSize + 'px';\r\n\r\n    // Set position result text\r\n    resultText.style.top = minY * heightZoom + (-20 * heightZoom) + \"px\";\r\n    resultText.style.left = minX * widthZoom + (imgWidth - imgHeight * oriWHRatio) * 0.5 + \"px\";\r\n\r\n    elTarget && elTarget.appendChild(qrcodeTooltip);\r\n    elTarget && elTarget.appendChild(resultText);\r\n  }\r\n\r\n  elTarget && elTarget.appendChild(cvs);\r\n}\r\n\r\n/**\r\n * DRAW_RESULT_ON_CANVAS\r\n * @param code \r\n * @param cvs \r\n * @param canvasStyles \r\n */\r\nexport const DRAW_RESULT_ON_CANVAS = (code: ScannerQRCodeResult, cvs: HTMLCanvasElement, canvasStyles?: CanvasRenderingContext2D) => {\r\n  let ctx = cvs.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n\r\n  let loc: any = {};\r\n  let X: any = [];\r\n  let Y: any = [];\r\n\r\n  // Point x,y\r\n  const points = code.location;\r\n  const drawFrame = (begin: Point, end: Point, j: number) => {\r\n    ctx.beginPath();\r\n    ctx.moveTo(begin.x, begin.y);\r\n    ctx.lineTo(end.x, end.y);\r\n    for (let key in canvasStyles) {\r\n      (ctx as any)[key] = (canvasStyles as any)[key];\r\n    }\r\n    ctx.stroke();\r\n    const xj = PROP_EXISTS(begin,'x') ? begin.x : 0;\r\n    const yj = PROP_EXISTS(begin,'y') ? begin.y : 0;\r\n    loc[`x${j + 1}`] = xj;\r\n    loc[`y${j + 1}`] = yj;\r\n    X.push(xj);\r\n    Y.push(yj);\r\n  };\r\n  drawFrame(points.topLeftCorner, points.topRightCorner, 0);\r\n  drawFrame(points.topRightCorner, points.bottomRightCorner, 1);\r\n  drawFrame(points.bottomRightCorner, points.bottomLeftCorner, 2);\r\n  drawFrame(points.bottomLeftCorner, points.topLeftCorner, 3);\r\n\r\n  // Min max\r\n  let minX = Math.min(...X);\r\n  let minY = Math.min(...Y);\r\n\r\n  // Style for canvas\r\n  for (const key in canvasStyles) {\r\n    (ctx as any)[key] = (canvasStyles as any)[key];\r\n  }\r\n  ctx.font = canvasStyles && canvasStyles.font ? canvasStyles.font : `15px serif`;\r\n  FILL_TEXT_MULTI_LINE(ctx, code.data, minX, minY - 5);\r\n\r\n  // polygon [x,y, x,y, x,y.....];\r\n  const polygon = [];\r\n  for (let k = 0; k < X.length; k++) {\r\n    polygon.push(loc[`x${k + 1}`]);\r\n    polygon.push(loc[`y${k + 1}`]);\r\n  }\r\n\r\n  // Copy array\r\n  const shape = polygon.slice(0) as any;\r\n\r\n  // Draw polygon\r\n  ctx.beginPath();\r\n  ctx.moveTo(shape.shift(), shape.shift());\r\n  while (shape.length) {\r\n    ctx.lineTo(shape.shift(), shape.shift()); //x,y\r\n  }\r\n  ctx.closePath();\r\n  ctx.fill();\r\n  ctx.stroke();\r\n}\r\n\r\n/**\r\n * READ_AS_DATA_URL\r\n * @param file \r\n * @param config \r\n * @return Promise\r\n */\r\nexport const READ_AS_DATA_URL = (file: File, configs: ScannerQRCodeConfig): Promise<ScannerQRCodeSelectedFiles> => {\r\n  /** overrides **/\r\n  let canvasStyles = (configs && configs.canvasStyles) ? configs.canvasStyles : CONFIG_DEFAULT.canvasStyles;\r\n  let isBeep = (configs && configs.isBeep) ? configs.isBeep : CONFIG_DEFAULT.isBeep;\r\n\r\n  /** drawImage **/\r\n  return new Promise((resolve, reject) => {\r\n    const fileReader = new FileReader();\r\n    fileReader.onload = () => {\r\n      const objectFile = {\r\n        name: file.name,\r\n        file: file,\r\n        url: URL.createObjectURL(file)\r\n      };\r\n      // Set the src of this Image object.\r\n      const image = new Image();\r\n      // Setting cross origin value to anonymous\r\n      image.setAttribute('crossOrigin', 'anonymous');\r\n      // When our image has loaded.\r\n      image.onload = async () => {\r\n        // Get the canvas element by using the getElementById method.\r\n        const canvas = document.createElement('canvas');\r\n        // HTMLImageElement size\r\n        canvas.width = image.naturalWidth || image.width;\r\n        canvas.height = image.naturalHeight || image.height;\r\n        // Get a 2D drawing context for the canvas.\r\n        const ctx = canvas.getContext('2d') as CanvasRenderingContext2D;\r\n        // Draw image\r\n        ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\r\n        // Data image\r\n        const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        // Scanner\r\n        const code = jsQR(imageData.data, imageData.width, imageData.height, {\r\n          inversionAttempts: \"dontInvert\",\r\n        }) as ScannerQRCodeResult;\r\n        if (code && code.data !== '') {\r\n          // Overlay\r\n          DRAW_RESULT_ON_CANVAS(code, canvas, canvasStyles);\r\n\r\n          // Emit object\r\n          const blob = await CANVAS_TO_BLOB(canvas);\r\n          const url = URL.createObjectURL(blob);\r\n          const blobToFile = (theBlob: any, fileName: string) => new File([theBlob], fileName, { lastModified: new Date().getTime(), type: theBlob.type });\r\n          resolve(Object.assign({}, objectFile, { data: code, url: url, canvas: canvas, file: blobToFile(blob, objectFile.name) }));\r\n\r\n          PLAY_AUDIO(isBeep);\r\n        } else {\r\n          resolve(Object.assign({}, objectFile, { data: code, canvas: canvas }));\r\n        }\r\n      };\r\n      // Set src\r\n      image.src = objectFile.url;\r\n    }\r\n    fileReader.onerror = (error: any) => reject(error);\r\n    fileReader.readAsDataURL(file);\r\n  })\r\n}\r\n\r\n/**\r\n * Convert canvas to blob\r\n * canvas.toBlob((blob) => { .. }, 'image/jpeg', 0.95); // JPEG at 95% quality\r\n * @param canvas \r\n * @param type \r\n * @return Promise\r\n */\r\nexport const CANVAS_TO_BLOB = (canvas: HTMLCanvasElement, type?: string): Promise<any> => {\r\n  return new Promise((resolve, reject) => canvas.toBlob(blob => resolve(blob), type));\r\n}\r\n\r\n/**\r\n * Convert blob to file\r\n * @param theBlob \r\n * @param fileName \r\n * @return File\r\n */\r\nexport const BLOB_TO_FILE = (theBlob: any, fileName: string): File => {\r\n  return new File([theBlob], fileName, { lastModified: new Date().getTime(), type: theBlob.type });\r\n}\r\n\r\n/**\r\n * FILES_TO_SCAN\r\n * @param files \r\n * @param configs \r\n * @param as \r\n * @returns \r\n */\r\nexport const FILES_TO_SCAN = (files: File[] = [], configs: ScannerQRCodeConfig, as = new AsyncSubject<ScannerQRCodeSelectedFiles[]>()): AsyncSubject<ScannerQRCodeSelectedFiles[]> => {\r\n  Promise.all(Object.assign([], files).map(m => READ_AS_DATA_URL(m, configs))).then((img: ScannerQRCodeSelectedFiles[]) => {\r\n    AS_COMPLETE(as, img);\r\n  }).catch((error: any) => AS_COMPLETE(as, null, error));\r\n  return as;\r\n}\r\n\r\n/**\r\n * FILL_TEXT_MULTI_LINE\r\n * @param ctx \r\n * @param text \r\n * @param x \r\n * @param y \r\n */\r\nexport const FILL_TEXT_MULTI_LINE = (ctx: CanvasRenderingContext2D, text: string, x: number, y: number) => {\r\n  let lineHeight = ctx.measureText(\"M\").width * 1.2;\r\n  let lines = text.split(\"\\n\");\r\n  for (var i = 0; i < lines.length; ++i) {\r\n    ctx.fillText(lines[i], x, y);\r\n    ctx.strokeText(lines[i], x, y);\r\n    y += lineHeight;\r\n  }\r\n}\r\n\r\n/**\r\n * COMPRESS_IMAGE\r\n * @param files \r\n * @param type \r\n * @param quality \r\n * @returns \r\n */\r\nexport const COMPRESS_IMAGE = async (files: File[], quality: number, type: string) => {\r\n  // No files selected\r\n  if (!files.length) return;\r\n\r\n  const compressImage = async (file: File): Promise<File> => {\r\n    // Get as image data\r\n    const imageBitmap = await createImageBitmap(file);\r\n\r\n    // Draw to canvas\r\n    const canvas = document.createElement('canvas');\r\n    canvas.width = imageBitmap.width;\r\n    canvas.height = imageBitmap.height;\r\n    const ctx = canvas.getContext('2d');\r\n    (ctx as any).drawImage(imageBitmap, 0, 0);\r\n\r\n    // Turn into Blob\r\n    const blob = await new Promise((resolve) =>\r\n      canvas.toBlob(resolve, type, quality)\r\n    ) as any;\r\n\r\n    // Turn Blob into File\r\n    return new File([blob], file.name, {\r\n      type: blob.type,\r\n    });\r\n  };\r\n\r\n  // We'll store the files in this data transfer object\r\n  const dataTransfer = new DataTransfer();\r\n\r\n  // For every file in the files list\r\n  for (const file of files) {\r\n    // We don't have to compress files that aren't images\r\n    if (!file.type.startsWith('image')) {\r\n      // Ignore this file, but do add it to our result\r\n      dataTransfer.items.add(file);\r\n      continue;\r\n    }\r\n\r\n    // We compress the file by 50%\r\n    const compressedFile = await compressImage(file);\r\n\r\n    // Save back the compressed file instead of the original file\r\n    dataTransfer.items.add(compressedFile);\r\n  }\r\n\r\n  // return value new files list\r\n  return dataTransfer.files;\r\n}\r\n\r\n/**\r\n * REMOVE_CANVAS\r\n * @param element \r\n */\r\nexport const REMOVE_CANVAS = (element: HTMLElement) => {\r\n  Object.assign([], element.childNodes).forEach(el => element.removeChild(el));\r\n}\r\n\r\n/**\r\n * VIBRATE\r\n * Báº­t rung trÃªn mobile\r\n * @param time \r\n */\r\nexport const VIBRATE = (time: number = 300) => {\r\n  time && IS_MOBILE() && window.navigator.vibrate(time);\r\n};\r\n\r\n/**\r\n * IS_MOBILE\r\n * @returns \r\n */\r\nexport const IS_MOBILE = () => {\r\n  const vendor = navigator.userAgent || navigator['vendor'] || (window as any)['opera'];\r\n  const phone = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i;\r\n  const version = /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i;\r\n  const isSafari = /^((?!chrome|android).)*safari/i;\r\n  return !!(phone.test(vendor) || version.test(vendor.substr(0, 4))) && !isSafari.test(vendor);\r\n};","import { Injectable } from '@angular/core';\r\nimport { AsyncSubject } from 'rxjs';\r\nimport { AS_COMPLETE, COMPRESS_IMAGE, FILES_TO_SCAN } from './ngx-scanner-qrcode-single.helper';\r\nimport { ScannerQRCodeConfig, ScannerQRCodeSelectedFiles } from './ngx-scanner-qrcode-single.options';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class NgxScannerQrcodeSingleService {\r\n\r\n  /**\r\n   * loadFiles\r\n   * @param files \r\n   * @param quality \r\n   * @param type \r\n   * @returns \r\n   */\r\n  public loadFiles(files: File[] = [], quality = 0.5, type = 'image/jpeg'): AsyncSubject<ScannerQRCodeSelectedFiles[]> {\r\n    const as = new AsyncSubject<ScannerQRCodeSelectedFiles[]>();\r\n    COMPRESS_IMAGE(files, quality, type).then((_files: any) => {\r\n      Promise.all(Object.assign([], _files).map((m: File) => this.readAsDataURL(m))).then((img: any[]) => AS_COMPLETE(as, img)).catch((error: any) => AS_COMPLETE(as, null, error));\r\n    }).catch(error => {\r\n      AS_COMPLETE(as, null, error as any);\r\n    });\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * loadFilesToScan\r\n   * @param files \r\n   * @param config \r\n   * @param quality \r\n   * @param type \r\n   * @returns \r\n   */\r\n  public loadFilesToScan(files: File[] = [], config: ScannerQRCodeConfig, quality = 0.5, type = 'image/jpeg'): AsyncSubject<ScannerQRCodeSelectedFiles[]> {\r\n    const as = new AsyncSubject<ScannerQRCodeSelectedFiles[]>();\r\n    COMPRESS_IMAGE(files, quality, type).then((_files: any) => {\r\n      FILES_TO_SCAN(_files, config, as);\r\n    }).catch(error => {\r\n      AS_COMPLETE(as, null, error as any);\r\n    });\r\n    return as\r\n  }\r\n\r\n  /**\r\n   * readAsDataURL\r\n   * @param file \r\n   * @return Promise\r\n   */\r\n  private readAsDataURL(file: File): Promise<ScannerQRCodeSelectedFiles> {\r\n    /** drawImage **/\r\n    return new Promise((resolve, reject) => {\r\n      const fileReader = new FileReader();\r\n      fileReader.onload = () => {\r\n        const objectFile = {\r\n          name: file.name,\r\n          file: file,\r\n          url: URL.createObjectURL(file)\r\n        };\r\n        resolve(objectFile);\r\n      }\r\n      fileReader.onerror = (error: any) => reject(error);\r\n      fileReader.readAsDataURL(file);\r\n    })\r\n  }\r\n}","import { Component, ElementRef, EventEmitter, OnDestroy, OnInit, ViewChild, ViewEncapsulation, AfterViewInit } from '@angular/core';\r\nimport jsQR from \"jsqr\";\r\nimport { AsyncSubject, BehaviorSubject } from 'rxjs';\r\nimport { CONFIG_DEFAULT, MEDIA_STREAM_DEFAULT } from './ngx-scanner-qrcode-single.default';\r\nimport { AS_COMPLETE, BLOB_TO_FILE, CANVAS_TO_BLOB, DRAW_RESULT_APPEND_CHILD, FILES_TO_SCAN, OVERRIDES, PLAY_AUDIO, PROP_EXISTS, REMOVE_CANVAS, VIBRATE } from './ngx-scanner-qrcode-single.helper';\r\nimport { ScannerQRCodeConfig, ScannerQRCodeDevice, ScannerQRCodeResult, ScannerQRCodeSelectedFiles } from './ngx-scanner-qrcode-single.options';\r\n\r\n@Component({\r\n  selector: 'ngx-scanner-qrcode-single',\r\n  template: `<div #resultsPanel class=\"origin-overlay\"></div><canvas #canvas class=\"origin-canvas\"></canvas><video #video playsinline class=\"origin-video\"></video>`,\r\n  styleUrls: ['./ngx-scanner-qrcode-single.component.scss'],\r\n  host: { 'class': 'ngx-scanner-qrcode-single' },\r\n  exportAs: 'scanner',\r\n  inputs: ['src', 'fps', 'vibrate', 'isBeep', 'config', 'constraints', 'canvasStyles'],\r\n  outputs: ['event'],\r\n  queries: {\r\n    video: new ViewChild('video'),\r\n    canvas: new ViewChild('canvas'),\r\n    resultsPanel: new ViewChild('resultsPanel')\r\n  },\r\n  encapsulation: ViewEncapsulation.None\r\n})\r\nexport class NgxScannerQrcodeSingleComponent implements OnInit, OnDestroy, AfterViewInit {\r\n\r\n  /**\r\n   * Element\r\n   * playsinline required to tell iOS safari we don't want fullscreen\r\n   */\r\n  public video!: ElementRef<HTMLVideoElement>;\r\n  public canvas!: ElementRef<HTMLCanvasElement>;\r\n  public resultsPanel!: ElementRef<HTMLDivElement>;\r\n\r\n  /**\r\n   * EventEmitter\r\n   */\r\n  public event = new EventEmitter<ScannerQRCodeResult>();\r\n\r\n  /**\r\n   * Input\r\n   */\r\n  public src: string | undefined = CONFIG_DEFAULT.src;\r\n  public fps: number | undefined = CONFIG_DEFAULT.fps;\r\n  public vibrate: number | undefined = CONFIG_DEFAULT.vibrate;\r\n  public isBeep: boolean | undefined = CONFIG_DEFAULT.isBeep;\r\n  public config: ScannerQRCodeConfig = CONFIG_DEFAULT;\r\n  public constraints: MediaStreamConstraints | any = CONFIG_DEFAULT.constraints;\r\n  public canvasStyles: CanvasRenderingContext2D | any = CONFIG_DEFAULT.canvasStyles;\r\n\r\n  /**\r\n   * Export\r\n  */\r\n  public isStart: boolean = false;\r\n  public isPause: boolean = false;\r\n  public isLoading: boolean = false;\r\n  public isTorch: boolean = false;\r\n  public data = new BehaviorSubject<ScannerQRCodeResult>(null);\r\n  public devices = new BehaviorSubject<ScannerQRCodeDevice[]>([]);\r\n  public deviceIndexActive: number = 0;\r\n\r\n  /**\r\n   * Private\r\n  */\r\n  private rAF_ID: any;\r\n  private dataForResize!: ScannerQRCodeResult;\r\n  private ready = new AsyncSubject<boolean>();\r\n\r\n  private STATUS = {\r\n    startON: () => this.isStart = true,\r\n    pauseON: () => this.isPause = true,\r\n    loadingON: () => this.isLoading = true,\r\n    startOFF: () => this.isStart = false,\r\n    pauseOFF: () => this.isPause = false,\r\n    loadingOFF: () => this.isLoading = false,\r\n    torchOFF: () => this.isTorch = false,\r\n  }\r\n\r\n  constructor() { }\r\n\r\n  ngOnInit(): void {\r\n    this.overrideConfig();\r\n    if (this.src) {\r\n      this.loadImage(this.src);\r\n    }\r\n    this.resize();\r\n  }\r\n  \r\n  ngAfterViewInit(): void {\r\n    setTimeout(() => AS_COMPLETE(this.ready, true), 1000);\r\n  }\r\n\r\n  /**\r\n   * start\r\n   * @param playDeviceCustom \r\n   * @return AsyncSubject\r\n   */\r\n  public start(playDeviceCustom?: Function): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isStart) {\r\n      // Reject\r\n      AS_COMPLETE(as, false);\r\n    } else {\r\n      // fix safari\r\n      this.safariWebRTC(as, playDeviceCustom);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * stop\r\n   * @return AsyncSubject\r\n   */\r\n  public stop(): AsyncSubject<any> {\r\n    this.STATUS.pauseOFF();\r\n    this.STATUS.startOFF();\r\n    this.STATUS.torchOFF();\r\n    this.STATUS.loadingOFF();\r\n    const as = new AsyncSubject<any>();\r\n    try {\r\n      clearInterval(this.rAF_ID);\r\n      (this.video.nativeElement.srcObject as MediaStream).getTracks().forEach((track: MediaStreamTrack) => {\r\n        track.stop();\r\n        AS_COMPLETE(as, true);\r\n      });\r\n      REMOVE_CANVAS(this.resultsPanel.nativeElement);\r\n    } catch (error) {\r\n      AS_COMPLETE(as, false, error as any);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * play\r\n   * @return AsyncSubject\r\n   */\r\n  public play(): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isPause) {\r\n      this.video.nativeElement.play();\r\n      this.STATUS.pauseOFF();\r\n      this.requestAnimationFrame(90);\r\n      AS_COMPLETE(as, true);\r\n    } else {\r\n      AS_COMPLETE(as, false);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * pause\r\n   * @return AsyncSubject \r\n   */\r\n  public pause(): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    if (this.isStart) {\r\n      clearInterval(this.rAF_ID);\r\n      this.video.nativeElement.pause();\r\n      this.STATUS.pauseON();\r\n      AS_COMPLETE(as, true);\r\n    } else {\r\n      AS_COMPLETE(as, false);\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * playDevice\r\n   * @param deviceId \r\n   * @param as \r\n   * @return AsyncSubject \r\n   */\r\n  public playDevice(deviceId: string, as: AsyncSubject<any> = new AsyncSubject<any>()): AsyncSubject<any> {\r\n    const existDeviceId = this.isStart ? this.getConstraints().deviceId !== deviceId : true;\r\n    switch (true) {\r\n      case deviceId === 'null' || deviceId === 'undefined' || !deviceId:\r\n        stop();\r\n        this.stop();\r\n        AS_COMPLETE(as, false);\r\n        break;\r\n      case deviceId && existDeviceId:\r\n        stop();\r\n        this.stop();\r\n        // Loading on\r\n        this.STATUS.loadingON();\r\n        this.deviceIndexActive = this.devices.value.findIndex((f: ScannerQRCodeDevice) => f.deviceId === deviceId);\r\n        const constraints = { ...this.constraints, audio: false, video: { deviceId: deviceId, ...this.constraints.video } };\r\n        // MediaStream\r\n        navigator.mediaDevices.getUserMedia(constraints).then((stream: MediaStream) => {\r\n          this.video.nativeElement.srcObject = stream;\r\n          this.video.nativeElement.onloadedmetadata = () => {\r\n            this.video.nativeElement.play();\r\n            this.requestAnimationFrame();\r\n            AS_COMPLETE(as, true);\r\n            this.STATUS.startON();\r\n            this.STATUS.loadingOFF();\r\n          }\r\n        }).catch((error: any) => {\r\n          this.eventEmit(false);\r\n          AS_COMPLETE(as, false, error);\r\n          this.STATUS.startOFF();\r\n          this.STATUS.loadingOFF();\r\n        });\r\n        break;\r\n      default:\r\n        AS_COMPLETE(as, false);\r\n        this.STATUS.loadingOFF();\r\n        break;\r\n    }\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * loadImage\r\n   * @param src \r\n   * @return AsyncSubject\r\n   */\r\n  public loadImage(src: string): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    // Loading on\r\n    this.STATUS.startOFF();\r\n    this.STATUS.loadingON();\r\n    // Set the src of this Image object.\r\n    const image = new Image();\r\n    // Setting cross origin value to anonymous\r\n    image.setAttribute('crossOrigin', 'anonymous');\r\n    // When our image has loaded.\r\n    image.onload = () => {\r\n      this.drawImage(image, (flag: boolean) => {\r\n        AS_COMPLETE(as, flag);\r\n        this.STATUS.startOFF();\r\n        this.STATUS.loadingOFF();\r\n      });\r\n    };\r\n    // Set src\r\n    image.src = src;\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * torcher\r\n   * @return AsyncSubject\r\n   */\r\n  public torcher(): AsyncSubject<any> {\r\n    const as = this.applyConstraints({ advanced: [{ torch: this.isTorch }] });\r\n    as.subscribe(() => false, () => this.isTorch = !this.isTorch);\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * applyConstraints\r\n   * @param constraints \r\n   * @return AsyncSubject\r\n   */\r\n  public applyConstraints(constraints: MediaTrackConstraintSet | MediaTrackConstraints | any): AsyncSubject<any> {\r\n    const as = new AsyncSubject<any>();\r\n    const stream = this.video.nativeElement.srcObject as MediaStream;\r\n    const videoTrack = stream.getVideoTracks()[0] as MediaStreamTrack;\r\n    const imageCapture = new (window as any).ImageCapture(videoTrack);\r\n    imageCapture.getPhotoCapabilities().then(async () => {\r\n      await videoTrack.applyConstraints(constraints);\r\n      AS_COMPLETE(as, true);\r\n    }).catch((error: any) => {\r\n      switch (error && error.name) {\r\n        case 'NotFoundError':\r\n        case 'DevicesNotFoundError':\r\n          AS_COMPLETE(as, false, 'Required track is missing' as any);\r\n          break;\r\n        case 'NotReadableError':\r\n        case 'TrackStartError':\r\n          AS_COMPLETE(as, false, 'Webcam or mic are already in use' as any);\r\n          break;\r\n        case 'OverconstrainedError':\r\n        case 'ConstraintNotSatisfiedError':\r\n          AS_COMPLETE(as, false, 'Constraints can not be satisfied by avb. devices' as any);\r\n          break;\r\n        case 'NotAllowedError':\r\n        case 'PermissionDeniedError':\r\n          AS_COMPLETE(as, false, 'Permission denied in browser' as any);\r\n          break;\r\n        case 'TypeError':\r\n          AS_COMPLETE(as, false, 'Empty constraints object' as any);\r\n          break;\r\n        default:\r\n          AS_COMPLETE(as, false, error as any);\r\n          break;\r\n      }\r\n    });\r\n    return as;\r\n  };\r\n\r\n  /**\r\n   * getConstraints\r\n   * @returns \r\n   */\r\n  public getConstraints(): MediaTrackConstraintSet | any {\r\n    const stream = this.video.nativeElement.srcObject as MediaStream;\r\n    const videoTrack = stream && stream.getVideoTracks()[0] as MediaStreamTrack;\r\n    return videoTrack && videoTrack.getConstraints() as any;\r\n  }\r\n\r\n  /**\r\n   * download\r\n   * @param fileName \r\n   * @return AsyncSubject\r\n   */\r\n  public download(fileName: string = `ngx-scanner-qrcode-single-${Date.now()}.png`): AsyncSubject<ScannerQRCodeSelectedFiles[]> {\r\n    const as = new AsyncSubject<any>();\r\n    const run = async () => {\r\n      const blob = await CANVAS_TO_BLOB(this.canvas.nativeElement);\r\n      const file = BLOB_TO_FILE(blob, fileName);\r\n      FILES_TO_SCAN([file], this.config, as).subscribe((res: ScannerQRCodeSelectedFiles[]) => {\r\n        res.forEach((item: ScannerQRCodeSelectedFiles) => {\r\n          const link = document.createElement('a');\r\n          link.href = item.url;\r\n          link.download = item.name;\r\n          link.click();\r\n          link.remove()\r\n        });\r\n      });\r\n    }\r\n    run();\r\n    return as;\r\n  }\r\n\r\n  /**\r\n   * window: resize\r\n   * Draw again!\r\n   */\r\n  private resize(): void {\r\n    window.addEventListener(\"resize\", () => {\r\n      if (this.dataForResize) {\r\n        DRAW_RESULT_APPEND_CHILD(this.dataForResize as any, this.canvas.nativeElement, this.resultsPanel.nativeElement, this.canvasStyles);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Override config\r\n   * @return void\r\n   */\r\n  private overrideConfig(): void {\r\n    if (PROP_EXISTS(this.config, 'src')) this.src = this.config.src;\r\n    if (PROP_EXISTS(this.config, 'fps')) this.fps = this.config.fps;\r\n    if (PROP_EXISTS(this.config, 'vibrate')) this.vibrate = this.config.vibrate;\r\n    if (PROP_EXISTS(this.config, 'isBeep')) this.isBeep = this.config.isBeep;\r\n    if (PROP_EXISTS(this.config, 'constraints')) this.constraints = OVERRIDES('constraints', this.config, MEDIA_STREAM_DEFAULT);\r\n    if (PROP_EXISTS(this.config, 'canvasStyles')) this.canvasStyles = this.config.canvasStyles;\r\n  }\r\n\r\n  /**\r\n   * safariWebRTC\r\n   * Fix issue on safari\r\n   * https://webrtchacks.com/guide-to-safari-webrtc\r\n   * @param as \r\n   * @param playDeviceCustom \r\n   */\r\n  private safariWebRTC(as: AsyncSubject<any>, playDeviceCustom?: Function): void {\r\n    // Loading on\r\n    this.STATUS.startOFF();\r\n    this.STATUS.loadingON();\r\n    navigator.mediaDevices.getUserMedia(this.constraints).then((stream: MediaStream) => {\r\n      stream.getTracks().forEach(track => track.stop());\r\n      this.loadAllDevices(as, playDeviceCustom);\r\n    }).catch((error: any) => {\r\n      AS_COMPLETE(as, false, error);\r\n      this.STATUS.startOFF();\r\n      this.STATUS.loadingOFF();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * loadAllDevices\r\n   * @param as \r\n   * @param playDeviceCustom \r\n   */\r\n  private loadAllDevices(as: AsyncSubject<any>, playDeviceCustom?: Function): void {\r\n    navigator.mediaDevices.enumerateDevices().then(devices => {\r\n      let cameraDevices: ScannerQRCodeDevice[] = devices.filter(f => f.kind == 'videoinput');\r\n      this.devices.next(cameraDevices);\r\n      if (cameraDevices.length > 0) {\r\n        AS_COMPLETE(as, cameraDevices);\r\n        playDeviceCustom ? playDeviceCustom(cameraDevices) : this.playDevice(cameraDevices[0].deviceId);\r\n      } else {\r\n        AS_COMPLETE(as, false, 'No camera detected.' as any);\r\n        this.STATUS.startOFF();\r\n        this.STATUS.loadingOFF();\r\n      }\r\n    }).catch((error: any) => {\r\n      AS_COMPLETE(as, false, error);\r\n      this.STATUS.startOFF();\r\n      this.STATUS.loadingOFF();\r\n    });\r\n  }\r\n\r\n  /**\r\n   * drawImage\r\n   * @param element \r\n   * @param callback \r\n   */\r\n  private async drawImage(element: HTMLImageElement | HTMLVideoElement, callback: Function = () => { }): Promise<void> {\r\n    // Get the canvas element by using the getElementById method.\r\n    const canvas = this.canvas.nativeElement;\r\n    // Get a 2D drawing context for the canvas.\r\n    const ctx = canvas.getContext('2d', { willReadFrequently: true }) as CanvasRenderingContext2D;\r\n    // HTMLImageElement size\r\n    if (element instanceof HTMLImageElement) {\r\n      canvas.width = element.naturalWidth;\r\n      canvas.height = element.naturalHeight;\r\n      element.style.visibility = '';\r\n      this.video.nativeElement.style.visibility = 'hidden';\r\n      this.video.nativeElement.style.height = canvas.offsetHeight + 'px';\r\n    }\r\n    // HTMLVideoElement size\r\n    if (element instanceof HTMLVideoElement) {\r\n      canvas.width = element.videoWidth;\r\n      canvas.height = element.videoHeight;\r\n      element.style.visibility = '';\r\n      this.canvas.nativeElement.style.visibility = 'hidden';\r\n    }\r\n    ctx.clearRect(0, 0, canvas.width, canvas.height)\r\n    // Draw image\r\n    ctx.drawImage(element, 0, 0, canvas.width, canvas.height);\r\n    // Data image\r\n    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n    // Draw frame\r\n    const code = jsQR(imageData.data, imageData.width, imageData.height, {\r\n      inversionAttempts: \"dontInvert\",\r\n    }) as ScannerQRCodeResult;\r\n    if (code && code.data !== '') {\r\n      // Overlay\r\n      DRAW_RESULT_APPEND_CHILD(code, this.canvas.nativeElement, this.resultsPanel.nativeElement, this.canvasStyles);\r\n\r\n      // To blob and emit data\r\n      const EMIT_DATA = () => {\r\n        this.eventEmit(code);\r\n        this.dataForResize = code;\r\n      };\r\n\r\n      // HTMLImageElement\r\n      if (element instanceof HTMLImageElement) {\r\n        callback(true);\r\n        EMIT_DATA();\r\n        VIBRATE(this.vibrate);\r\n        PLAY_AUDIO(this.isBeep);\r\n      }\r\n      // HTMLVideoElement\r\n      if (element instanceof HTMLVideoElement) {\r\n        EMIT_DATA();\r\n        VIBRATE(this.vibrate);\r\n        PLAY_AUDIO(this.isBeep);\r\n      }\r\n    } else {\r\n      callback(false);\r\n      REMOVE_CANVAS(this.resultsPanel.nativeElement);\r\n      this.dataForResize = code;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * eventEmit\r\n   * @param response \r\n   */\r\n  private eventEmit(response: any = false): void {\r\n    (response !== false) && this.data.next(response || { data: null });\r\n    (response !== false) && this.event.emit(response || { data: null });\r\n  }\r\n\r\n  /**\r\n   * Single-thread\r\n   * Loop Recording on Camera\r\n   * Must be destroy request \r\n   * Not using: requestAnimationFrame\r\n   * @param delay\r\n   */\r\n  private requestAnimationFrame(delay: number = 0): void {\r\n    this.rAF_ID = setInterval(() => {\r\n      if (this.video.nativeElement.readyState === this.video.nativeElement.HAVE_ENOUGH_DATA) {\r\n        delay = 0;\r\n        this.drawImage(this.video.nativeElement);\r\n      }\r\n    }, /*avoid cache mediaStream*/ delay || this.fps);\r\n  }\r\n\r\n  /**\r\n   * Status of wasm\r\n   * @return AsyncSubject\r\n   */\r\n  get isReady(): AsyncSubject<boolean> {\r\n    return this.ready;\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.pause();\r\n  }\r\n}\r\n","import { NgModule } from \"@angular/core\";\r\nimport { NgxScannerQrcodeSingleService } from \"./ngx-scanner-qrcode-single.service\";\r\nimport { NgxScannerQrcodeSingleComponent } from \"./ngx-scanner-qrcode-single.component\";\r\n\r\n\r\n@NgModule({\r\n  declarations: [NgxScannerQrcodeSingleComponent],\r\n  exports: [NgxScannerQrcodeSingleComponent],\r\n  providers: [NgxScannerQrcodeSingleService],\r\n})\r\nexport class NgxScannerQrcodeSingleModule {}\r\n"],"names":[],"mappings":"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"}
